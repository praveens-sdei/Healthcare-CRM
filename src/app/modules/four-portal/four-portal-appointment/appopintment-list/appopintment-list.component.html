<div class="doctor_appointment dashboard_main_content">
  <div class="top_bar">
    <div class="content_wrap" *ngIf="!showscheduler">
      <div class="top_item" *ngIf="userRole === 'STAFF'">
        <div class="form_field_wrapper">
          <label>{{ "doctor_list" | translate }}</label>
          <mat-form-field appearance="fill">
            <mat-select placeholder="{{ 'doctor_list' | translate }}"
              (selectionChange)="handleSelectDoctorList($event)">
              <mat-option *ngFor="let item of doctor_name; let i = index" value="{{ item.full_name }}">{{ item.full_name
                }}</mat-option>
              <mat-option value="ALL">{{ "all" | translate }}</mat-option>
            </mat-select>
          </mat-form-field>
        </div>
      </div>
      <div class="top_item">
        <div class="form_field_wrapper">
          <label>{{ "status" | translate }}</label>
          <mat-form-field appearance="fill">
            <mat-select [(ngModel)]="selectedStatus" placeholder="Appointments Status"
              (selectionChange)="handleSelectFliterList($event)">
              <mat-option value="ALL">{{ "all" | translate }}</mat-option>
              <mat-option value="NEW">{{ "new" | translate }}</mat-option>
              <mat-option value="TODAY">{{ "today" | translate }}</mat-option>
              <mat-option value="UPCOMING">{{
                "upcoming" | translate
                }}</mat-option>
              <mat-option value="PAST">{{ "past" | translate }}</mat-option>
              <mat-option value="REJECTED">{{
                "rejected" | translate
                }}</mat-option>
              <mat-option value="MISSED">{{ "missed" | translate }}</mat-option>
            </mat-select>
          </mat-form-field>
        </div>
      </div>
      <div class="top_item">
        <div class="form_field_wrapper">
          <label>{{ "consultation_type" | translate }}</label>
          <mat-form-field appearance="fill">
            <div style="width: 50%"></div>
            <mat-select placeholder="{{ 'appointments_type' | translate }} " [(ngModel)]="consultationType"
              (selectionChange)="handleSelectFliterTypeList($event)">
              <mat-option value="ALL">{{ "all" | translate }}</mat-option>
              <mat-option value="ONLINE">{{ "online" | translate }}</mat-option>
              <mat-option value="FACE_TO_FACE">{{
                "face_to_face" | translate
                }}</mat-option>
              <mat-option value="HOME_VISIT">{{
                "home_visit" | translate
                }}</mat-option>
            </mat-select>
          </mat-form-field>
        </div>
      </div>
      <div class="top_item date">
        <div class="form_field_wrapper">
          <label>{{ "appointment_date" | translate }}</label>
          <mat-form-field class="example-full-width" appearance="fill">
            <input matInput placeholder="{{ 'date' | translate }}" [(ngModel)]="dateFilter" [matDatepicker]="picker1"
              (dateChange)="handleSelectDateFilter($event)" />
            <mat-datepicker-toggle matSuffix [for]="picker1"></mat-datepicker-toggle>
            <mat-datepicker #picker1></mat-datepicker>
          </mat-form-field>
        </div>
      </div>
      <div class="primary_btn">
        <button type="button" class="btn btn-link" (click)="clearDateFilter()">
          {{ "clear_date" | translate }}
        </button>
      </div>
      <div class="primary_btn top_item">
        <ng-container *ngIf="giveInnerPermission('cancel_appointment')">
          <button class="btn btn-primary" (click)="
            openVerticallyCenteredselectdaterange(select_daterangecontent)
          ">
            {{ "cancel_appointment" | translate }}
          </button>
        </ng-container>
      </div>
      <div class="primary_btn top_item">
        <ng-container *ngIf="giveInnerPermission('add_new_appointment')">

          <button class="btn btn-primary" (click)="routeTONewApp()">
            {{ "new_appointment" | translate }}
          </button>
        </ng-container>
      </div>
    </div>
  </div>

  <div class="bottom_bar">
    <div class="appointment_tab">
      <mat-tab-group animationDuration="0ms">
        <mat-tab>
          <ng-template mat-tab-label>
            <div class="btn_svg" (click)="showschedule(false)">
              <svg xmlns="http://www.w3.org/2000/svg" width="25" height="19" viewBox="0 0 25 19" fill="none">
                <path fill-rule="evenodd" clip-rule="evenodd"
                  d="M0.288748 0.364133C0.0923893 0.628986 0.0189067 1.13494 0.0189067 2.22236C0.0189067 4.20655 0.0792183 4.25863 2.38093 4.25863C3.49391 4.25863 4.18299 4.18869 4.31695 4.06208C4.453 3.9335 4.52492 3.25524 4.52492 2.1023C4.52492 -0.0296249 4.55751 2.17077e-05 2.20641 2.17077e-05C0.700009 2.17077e-05 0.535365 0.031306 0.288748 0.364133ZM6.70116 0.364133C6.50792 0.624727 6.43132 1.12626 6.43132 2.12933C6.43132 3.13239 6.50792 3.63393 6.70116 3.89452L6.97083 4.25863H15.6863C23.9095 4.25863 24.4178 4.24176 24.6885 3.95906C25.0869 3.54302 25.0994 0.895476 24.7055 0.364133L24.4358 2.17077e-05H15.7033H6.97083L6.70116 0.364133ZM0.305732 7.67027C-0.0927038 8.08631 -0.105182 10.7339 0.288748 11.2652C0.535365 11.598 0.700009 11.6293 2.20641 11.6293C4.56132 11.6293 4.52492 11.6627 4.52492 9.5C4.52492 7.33876 4.55941 7.37069 2.22356 7.37069C0.863612 7.37069 0.544898 7.42049 0.305732 7.67027ZM6.70116 7.73481C6.50792 7.9954 6.43132 8.49693 6.43132 9.5C6.43132 10.5031 6.50792 11.0046 6.70116 11.2652L6.97083 11.6293H15.7033H24.4358L24.7055 11.2652C24.8987 11.0046 24.9753 10.5031 24.9753 9.5C24.9753 8.49693 24.8987 7.9954 24.7055 7.73481L24.4358 7.37069H15.7033H6.97083L6.70116 7.73481ZM0.305732 15.0409C-0.0927038 15.457 -0.105182 18.1045 0.288748 18.6359C0.535365 18.9687 0.700009 19 2.20641 19C4.55751 19 4.52492 19.0296 4.52492 16.8977C4.52492 15.7448 4.453 15.0665 4.31695 14.9379C4.18247 14.8108 3.48715 14.7414 2.35077 14.7414C0.867598 14.7414 0.547671 14.7882 0.305732 15.0409ZM6.70116 15.1055C6.50792 15.3661 6.43132 15.8676 6.43132 16.8707C6.43132 17.8737 6.50792 18.3753 6.70116 18.6359L6.97083 19H15.7033H24.4358L24.7055 18.6359C25.1226 18.0732 25.0874 15.3795 24.6583 15.0124C24.3724 14.7677 23.4947 14.7414 15.6562 14.7414H6.97083L6.70116 15.1055Z" />
              </svg>
            </div>
          </ng-template>
          <div class="tab_content">
            <div class="table-wrap">
              <div class="table-inner">
                <table mat-table [dataSource]="dataSource" class="mat-elevation-z8">
                  <ng-container matColumnDef="dateofcreations">
                    <th mat-header-cell *matHeaderCellDef (click)="onSortData('createdAt')">
                      <span> {{ "date_of_creation" | translate }} </span>
                      <span *ngIf="sortColumn === 'createdAt'" class="material-icons sorticon">{{ sortIconClass
                        }}</span>
                    </th>
                    <td mat-cell *matCellDef="let element">
                      <span class="name_user">{{
                        element?.createdAt | date : "dd-MM-yyyy HH:mm"
                        }}</span>
                    </td>
                  </ng-container>
                  <!-- Patient Name Column -->
                  <ng-container matColumnDef="patientname">
                    <th mat-header-cell *matHeaderCellDef (click)="onSortData('patientDetails.patientFullName')">
                      {{ "patient_name" | translate }}
                      <span *ngIf="sortColumn === 'patientDetails.patientFullName'" class="material-icons sorticon">{{
                        sortIconClass }}</span>
                    </th>
                    <td mat-cell *matCellDef="let element">
                      <span class="user_image_wrapper">
                        <img class="user_image" src="
                              ../../../../../assets/img/default_user.png
                            " />
                      </span>
                      <span class="name_user">{{ element?.patient_name }}
                      </span>
                    </td>
                  </ng-container>
                  <!--Assign Doctor name Column -->

                  <ng-container matColumnDef="assigndoctorname">
                    <th mat-header-cell *matHeaderCellDef (click)="onSortData('doctor_name')">
                      <span *ngIf="userRole === 'STAFF'">{{ "appointment_for" | translate }}
                      </span>
                      <span *ngIf="sortColumn === 'doctor_name'" class="material-icons sorticon">{{ sortIconClass
                        }}</span>
                    </th>
                    <td mat-cell *matCellDef="let element">
                      <span class="name_user" *ngIf="userRole === 'STAFF'">{{
                        element?.doctor_name
                        }}</span>
                    </td>
                  </ng-container>

                  <!--Date & Time Column -->
                  <ng-container matColumnDef="dateandtime">
                    <th mat-header-cell *matHeaderCellDef (click)="onSortData('consultationDate')">
                      {{ "appointment_date_time" | translate }}
                      <span *ngIf="sortColumn === 'consultationDate'" class="material-icons sorticon">{{ sortIconClass
                        }}</span>
                    </th>
                    <td mat-cell *matCellDef="let element">
                      {{ element?.consultation_date | date : "dd/MM/YYYY" }} |
                      {{ element?.consultation_time }}
                    </td>
                  </ng-container>

                  <!-- Appointments Type : -->
                  <ng-container matColumnDef="location">
                    <th mat-header-cell *matHeaderCellDef (click)="onSortData('hospital_details.hospital_name')">
                      {{ "location" | translate }}
                      <span *ngIf="sortColumn === 'hospital_details.hospital_name'" class="material-icons sorticon">{{
                        sortIconClass }}</span>
                    </th>
                    <td mat-cell *matCellDef="let element">
                      {{ element?.hospital_details?.hospital_name }}
                    </td>
                  </ng-container>

                  <!-- Appointments Type : -->
                  <ng-container matColumnDef="appointmentstype">
                    <th mat-header-cell *matHeaderCellDef (click)="onSortData('appointmentType')">
                      {{ "appointments_type" | translate }}
                      <span *ngIf="sortColumn === 'appointmentType'" class="material-icons sorticon">{{ sortIconClass
                        }}</span>
                    </th>
                    <td mat-cell *matCellDef="let element">
                      {{ element?.consultation_type }}
                    </td>
                  </ng-container>

                  <!-- Reason for Appt  -->
                  <ng-container matColumnDef="reasonforappt">
                    <th mat-header-cell *matHeaderCellDef (click)="onSortData('reasonForAppointment')">
                      {{ "reason_for_appt" | translate }}
                      <span *ngIf="sortColumn === 'reasonForAppointment'" class="material-icons sorticon">{{
                        sortIconClass }}</span>
                    </th>
                    <td mat-cell *matCellDef="let element">
                      {{ element?.reason_for_appointment }}
                    </td>
                  </ng-container>

                  <!-- Fee -->
                  <ng-container matColumnDef="fee">
                    <th mat-header-cell *matHeaderCellDef (click)="onSortData('consultationFee')">
                      {{ "fee" | translate }}
                      <span *ngIf="sortColumn === 'consultationFee'" class="material-icons sorticon">{{ sortIconClass
                        }}</span>
                    </th>
                    <td mat-cell *matCellDef="let element">
                      {{ element?.fee ? "$ " + element?.fee : "" }}
                    </td>
                  </ng-container>

                  <!-- Status -->
                  <ng-container matColumnDef="status">
                    <th mat-header-cell *matHeaderCellDef (click)="onSortData('status')">
                      {{ "status" | translate }}
                      <span *ngIf="sortColumn === 'status'" class="material-icons sorticon">{{ sortIconClass }}</span>
                    </th>
                    <td mat-cell *matCellDef="let element">
                      <div class="status {{
                          element.status === 'New'
                            ? 'new'
                            : element.status === 'Upcoming'
                            ? 'upcoming'
                            : element.status === 'Rejected'
                            ? 'rejected'
                            : element.status === 'Past'
                            ? 'past'
                            : element.status === 'Missed'
                            ? 'rejected'
                            : ''
                        }}">
                        {{ (element.status === 'Rejected' && element.cancel_by === 'patient')
                        ? 'Cancelled By Patient'
                        : element.status
                        }}
                      </div>
                      <!-- <div class="status solved"> {{element.status}} </div>
                                              <div class="status past"> {{element.status}} </div>
                                              <div class="status rejected"> {{element.status}} </div> -->
                    </td>
                  </ng-container>

                  <!--Action column -->
                  <ng-container matColumnDef="action">
                    <th mat-header-cell *matHeaderCellDef>
                      {{ "action" | translate }}
                    </th>
                    <td mat-cell *matCellDef="let element">
                      <div class="icon_group">
                        <ng-container *ngIf="giveInnerPermission('view_appointment')">

                          <a class="svgicon">
                            <mat-icon type="button" id="dropdownMenuButton1" data-bs-toggle="dropdown"
                              aria-expanded="false">
                              visibility
                            </mat-icon>
                            <ul class="action_dropmenu dropdown-menu" aria-labelledby="dropdownMenuButton1">
                              <li class="pointer" style="cursor: pointer"
                                (click)="goTo_details(element?.appointment_id)">
                                {{ "view_appointment" | translate }}
                              </li>

                              <ng-container>
                                <!-- {{today}} {{element.consultation_date}} -->
                                <li class="pointer" style="cursor: pointer"
                                  *ngIf="element.status === 'Past' && element.isPrescriptionValidate === false" (click)="
                                  routeTOePesrciption(element?.appointment_id)
                                ">
                                  {{ "add_ePrescription" | translate }}
                                </li>

                                <li class="pointer" style="cursor: pointer" *ngIf="
                                  element.status === 'Approved' ||
                                  element.status === 'Upcoming' ||
                                  element.status === 'Today'
                                " (click)="
                                  openVerticallyCenteredrechedule(
                                    choosedate,
                                    element
                                  )
                                ">
                                  {{ "reschedule" | translate }}
                                </li>
                              </ng-container>

                              <li *ngIf="
                                element.status === 'Approved' ||
                                element.status === 'Upcoming' ||
                                element.status === 'Today'
                              " class="pointer" style="cursor: pointer" (click)="
                                openVerticallyCenteredremainder(
                                  remaindermodal,
                                  element
                                )
                              ">
                                {{ "set_reminder" | translate }}
                              </li>
                            </ul>
                          </a>
                        </ng-container>

                        <ng-container *ngIf="giveInnerPermission('accept_appointment_request')">

                          <a class="svgicon" (click)="
                            openVerticallyCenteredapproved(
                              approved,
                              element?.appointment_id,
                              element?.portalId
                            )
                          " *ngIf="
                            element?.status === 'New' || element?.status === ''
                          ">
                            <svg xmlns="http://www.w3.org/2000/svg" width="18" height="13" viewBox="0 0 18 13"
                              fill="none">
                              <path fill-rule="evenodd" clip-rule="evenodd"
                                d="M16.0599 1.01833C16.0083 1.03131 15.9168 1.06637 15.8565 1.09623C15.7963 1.1261 13.6881 3.17305 11.1711 5.64552L6.59516 10.1405L4.42834 8.01378C2.90597 6.51963 2.21962 5.86623 2.12068 5.81702C1.93063 5.72247 1.62585 5.7201 1.44584 5.81179C1.27792 5.89732 1.11027 6.0835 1.04128 6.26109C0.973349 6.43591 0.990558 6.67834 1.08333 6.85368C1.17701 7.03082 6.14003 11.8938 6.28893 11.9544C6.43815 12.0151 6.75154 12.0152 6.90107 11.9546C7.04975 11.8942 16.8279 2.29847 16.9293 2.11334C17.0233 1.94181 17.0236 1.60932 16.93 1.43668C16.7605 1.12428 16.3752 0.939004 16.0599 1.01833Z"
                                fill="#72D284" stroke="#72D284" stroke-width="0.5" />
                            </svg>
                          </a>
                        </ng-container>
                        <!-- {{element|json}} -->
                        <ng-container *ngIf="giveInnerPermission('reject_appointment_request')">

                          <a class="svgicon" *ngIf="element?.status === 'New'" (click)="
                            openVerticallyCenteredrejectappointment(
                              rejectappointment,
                              element.appointment_id,
                              element.portalId
                            )
                          ">
                            <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 14 14"
                              fill="none">
                              <path fill-rule="evenodd" clip-rule="evenodd"
                                d="M0.732011 0.0273918C0.447072 0.0832955 0.198888 0.27729 0.0752607 0.540672C0.0156383 0.667687 0.00265662 0.734558 0.00265662 0.914713C0.00260185 1.33793 -0.182811 1.12777 2.9456 4.25067L5.71266 7.01287L2.92336 9.80275C0.656614 12.07 0.122038 12.6183 0.0699202 12.7294C-0.0215539 12.9245 -0.0235805 13.2738 0.0656477 13.4679C0.145373 13.6413 0.319666 13.8216 0.495603 13.9124C0.693998 14.0149 1.00909 14.0292 1.23506 13.946C1.39388 13.8874 1.49305 13.792 4.19981 11.0924L7.00026 8.29945L9.78684 11.0782C12.0251 13.3101 12.6004 13.8698 12.7104 13.9222C12.8253 13.977 12.8892 13.9875 13.1075 13.9871C13.3354 13.9868 13.3848 13.9777 13.5057 13.9144C13.6735 13.8264 13.8586 13.6316 13.9383 13.459C14.0237 13.2742 14.0198 12.9204 13.9303 12.7294C13.8782 12.6183 13.3436 12.07 11.0769 9.80275L8.28757 7.01287L11.0546 4.25067C14.183 1.12777 13.9976 1.33793 13.9976 0.914713C13.9976 0.735542 13.9845 0.667769 13.9265 0.544912C13.7048 0.075282 13.1486 -0.118303 12.6839 0.112396C12.6115 0.148307 11.6127 1.12575 9.78679 2.9473L7.00012 5.72741L4.21345 2.9473C2.38758 1.12575 1.38871 0.148307 1.31635 0.112396C1.22367 0.0663931 0.919259 -0.00917537 0.867141 0.000916846C0.858623 0.00255786 0.797796 0.0144552 0.732011 0.0273918Z"
                                fill="#FF7354" />
                            </svg>
                          </a>
                        </ng-container>
                      </div>
                      <button type="button" class="btn btn-primary"
                        *ngIf="
                          element.paymentType == 'post-payment' &&
                          element.patieintDetailpatientId != null && element.status == 'Past' && element.appointment_complete == 'false'" (click)="
                          submitclaimAppointment(
                            element.appointment_id,
                            element.portalId
                          )
                        ">
                        {{ "submit_claim" | translate }}
                      </button>
                    </td>
                  </ng-container>

                  <ng-container> </ng-container>

                  <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
                  <tr mat-row *matRowDef="let row; columns: displayedColumns"></tr>
                </table>
              </div>
              <div *ngIf="allAppointmentList?.length === 0" class="text-center">
                <b>{{ "no_record_found" | translate }}</b>
              </div>
              <mat-paginator class="pagination" [length]="totalLength" (page)="handlePageEvent($event)"
                [pageSize]="pageSize" [pageSizeOptions]="[5, 20, 50, 100]" showFirstLastButtons
                aria-label="Select page of periodic elements">
              </mat-paginator>
            </div>
          </div>
        </mat-tab>

        <mat-tab>
          <ng-template mat-tab-label>
            <div class="btn_svg" (click)="showschedule(true)">
              <svg xmlns="http://www.w3.org/2000/svg" width="29" height="31" viewBox="0 0 29 31" fill="none">
                <path fill-rule="evenodd" clip-rule="evenodd"
                  d="M21.3001 1.26796L21.3016 2.42363C25.5484 2.75646 28.3537 5.65026 28.3582 10.088L28.375 23.0778C28.3811 27.9162 25.3414 30.8932 20.469 30.9009L8.56749 30.9163C3.72559 30.9225 0.647842 27.8746 0.641754 23.0223L0.62501 10.1851C0.618922 5.71806 3.32527 2.83197 7.57201 2.44212L7.57049 1.28645C7.56897 0.608456 8.07127 0.0984203 8.74101 0.0984203C9.41075 0.0968794 9.91305 0.605375 9.91457 1.28337L9.9161 2.36199L18.9576 2.34967L18.956 1.27104C18.9545 0.593047 19.4568 0.0845522 20.1265 0.0830113C20.7811 0.0814704 21.2986 0.589966 21.3001 1.26796ZM2.97064 10.6601L26.0157 10.6292V10.0899C25.9502 6.777 24.2881 5.03887 21.3047 4.78L21.3062 5.96649C21.3062 6.62908 20.7902 7.15452 20.1357 7.15452C19.466 7.15606 18.9621 6.63216 18.9621 5.96957L18.9606 4.72145L9.91917 4.73377L9.92069 5.98036C9.92069 6.64448 9.41991 7.16839 8.75017 7.16839C8.08043 7.16993 7.57661 6.64757 7.57661 5.98344L7.57509 4.79695C4.60693 5.09434 2.96455 6.83864 2.96912 10.1808L2.97064 10.6601ZM19.4945 17.6629V17.6799C19.5097 18.3887 20.0881 18.9265 20.7898 18.9111C21.4748 18.8941 22.0212 18.307 22.006 17.5982C21.9741 16.9202 21.4246 16.367 20.7411 16.3686C20.0409 16.384 19.493 16.9541 19.4945 17.6629ZM20.7522 24.5816C20.052 24.5662 19.4873 23.9822 19.4858 23.2734C19.4705 22.5646 20.0322 21.9775 20.7324 21.9606H20.7476C21.463 21.9606 22.0429 22.5446 22.0429 23.2688C22.0445 23.993 21.4661 24.5801 20.7522 24.5816ZM13.2241 17.6882C13.2545 18.397 13.8344 18.9502 14.5346 18.9194C15.2196 18.887 15.766 18.3015 15.7356 17.5927C15.7188 16.8993 15.1556 16.3599 14.4707 16.3615C13.7705 16.3923 13.2225 16.9794 13.2241 17.6882ZM14.5407 24.5133C13.8406 24.5441 13.2621 23.9909 13.2302 23.2821C13.2302 22.5733 13.7766 21.9878 14.4768 21.9554C15.1618 21.9539 15.7265 22.4932 15.7417 23.185C15.7737 23.8954 15.2257 24.4809 14.5407 24.5133ZM6.95276 17.7416C6.9832 18.4505 7.56313 19.0052 8.26331 18.9728C8.94827 18.942 9.49471 18.3549 9.46275 17.6461C9.44753 16.9527 8.88434 16.4134 8.19786 16.4149C7.49768 16.4457 6.95123 17.0328 6.95276 17.7416ZM8.26933 24.5216C7.56915 24.5539 6.99074 23.9992 6.95878 23.2904C6.95726 22.5816 7.50522 21.9945 8.2054 21.9637C8.89036 21.9621 9.45507 22.5015 9.47029 23.1949C9.50226 23.9037 8.95581 24.4908 8.26933 24.5216Z" />
              </svg>
            </div>
          </ng-template>
          <div class="tab_content">
            <app-appointment-calender *ngIf="showscheduler"></app-appointment-calender>
          </div>
        </mat-tab>
      </mat-tab-group>
    </div>
  </div>
</div>

<!-- ---------------------------------------Select Date Range modal---------------------------------------- -->
<div class="select_date_range">
  <ng-template #select_daterangecontent let-modal>
    <div class="custome_modal">
      <div class="modal-header">
        <h4 class="modal-title" id="modal-basic-title">
          {{ "select_date_range_for_cancel_appointment" | translate }}
        </h4>
        <button type="button" class="btn-close" aria-label="Close" (click)="modal.dismiss('Cross click')">
          <mat-icon>close</mat-icon>
        </button>
      </div>

      <div class="modal-body">
        <div class="top_item" *ngIf="userRole === 'STAFF'">
          <div class="form_field_wrapper">
            <label>{{ "select_doctor" | translate }}</label>
            <mat-form-field appearance="fill">
              <mat-select placeholder="Doctor List" (selectionChange)="onDoctorSelection($event)">
                <mat-option *ngFor="let item of doctor_name; let i = index" value="{{ item?.for_portal_user }}">{{
                  item?.full_name }}</mat-option>
              </mat-select>
            </mat-form-field>
          </div>
        </div>
        <form [formGroup]="dateCancelAppointmentForm">
          <div class="row">
            <div class="item col-md-12">
              <div class="form_field_wrapper">
                <label>{{ "select_type" | translate
                  }}<span class="danger">*</span></label>
                <mat-form-field appearance="fill">
                  <mat-select [formControl]="appointments" multiple placeholder="{{ 'select_type' | translate }}">
                    <mat-select-trigger>
                      {{appointments.value?.[0] || ''}}
                      <span *ngIf="(appointments.value?.length || 0) > 1" class="example-additional-selection">
                        (+{{ (appointments.value?.length || 0) - 1 }}
                        {{
                        appointments.value?.length === 2 ? "other" : "others"
                        }})
                      </span>
                    </mat-select-trigger>
                    <mat-option *ngFor="let appointment of appointmentList" [value]="appointment">{{ appointment
                      }}</mat-option>
                  </mat-select>
                </mat-form-field>
                <!-- <span
                    class="text-danger"
                    *ngIf="
                      (f.appoint?.touched || isSubmitted) &&
                      f.appoint?.errors?.required
                    "
                  >
                    Please select appointment type.
                  
                  </span> -->
              </div>
            </div>
            <div class="item col-sm-6">
              <label>{{ "select_date" | translate
                }}<span class="danger">*</span></label>
              <div class="form_field_wrapper">
                <mat-form-field class="example-full-width" appearance="fill">
                  <input matInput [matDatepickerFilter]="myFilter" placeholder="{{ 'from' | translate }}"
                    [matDatepicker]="picker1" formControlName="fromDate" />
                  <mat-datepicker-toggle matSuffix [for]="picker1"></mat-datepicker-toggle>
                  <mat-datepicker #picker1></mat-datepicker>
                </mat-form-field>
                <span class="text-danger" *ngIf="isSubmitted && f['fromDate'].errors?.['required']">{{ "required" |
                  translate }}*</span>
              </div>
            </div>
            <div class="item col-sm-6">
              <label class="invisible">{{ "select_date" | translate
                }}<span class="danger">*</span></label>
              <div class="form_field_wrapper">
                <mat-form-field class="example-full-width" appearance="fill">
                  <input matInput [matDatepickerFilter]="myFilter" placeholder="{{ 'to' | translate }}"
                    [matDatepicker]="picker2" formControlName="toDate" />
                  <mat-datepicker-toggle matSuffix [for]="picker2"></mat-datepicker-toggle>
                  <mat-datepicker #picker2></mat-datepicker>
                </mat-form-field>
                <span class="text-danger" *ngIf="isSubmitted && f['toDate'].errors?.['required']">{{ "required" |
                  translate }}*</span>
              </div>
            </div>
          </div>
        </form>
        <div class="primary_btn mt-2">
          <button type="button" class="btn btn-secondary" (click)="modal.dismiss('Cross click')">
            {{ "back" | translate }}
          </button>
          <button type="button" class="btn btn-primary" (click)="handerdaterangeappointment()">
            {{ "cancel_appointment" | translate }}
          </button>
        </div>
      </div>
    </div>
  </ng-template>
</div>

<!-- Approved modal -->
<ng-template #approved let-modal>
  <div class="custome_modal action_modals">
    <div class="modal-body">
      <div class="delete_screen text-center">
        <div class="image approved">
          <img class="img-fluid" src="../../../../assets/img/approved.svg" alt="" />
        </div>
        <span class="single_text">{{
          "do_you_really_want_to_approve" | translate
          }}</span>
        <div class="primary_btn mt-30">
          <button type="button" class="btn btn-secondary" (click)="modal.dismiss('Cross click')">
            {{ "no" | translate }}
          </button>
          <button type="button" class="btn btn-primary" (click)="approveOrRejectedAppointment('APPROVED', '')">
            {{ "yes" | translate }}
          </button>
        </div>
      </div>
    </div>
  </div>
</ng-template>

<!-- Canel date range appointment modal -->
<ng-template #canceldaterangeappointment let-modal>
  <div class="custome_modal action_modals">
    <div class="modal-body">
      <form [formGroup]="dateCancelAppointmentForm">
        <div class="delete_screen text-center">
          <div class="image approved">
            <img class="img-fluid" src="../../../../assets/img/approved.svg" alt="" />
          </div>
          <span class="single_text">{{
            "do_you_want_cancel_date_range_appointment" | translate
            }}</span>
          <span class="single_text">{{ "from" | translate }}:
            {{ dateCancelAppointmentForm.value.fromDate | date : "dd/MM/YYYY" }}
          </span>
          <span class="single_text">{{ "to" | translate }}:
            {{
            dateCancelAppointmentForm.value.toDate | date : "dd/MM/YYYY"
            }}</span>

          <div class="primary_btn mt-30">
            <button type="button" class="btn btn-secondary" (click)="modal.dismiss('Cross click')">
              {{ "no" | translate }}
            </button>
            <button type="button" class="btn btn-primary" (click)="
                openVerticallyCenteredcancelappointment(cancelappintmentcontent)
              ">
              {{ "yes" | translate }}
            </button>
          </div>
        </div>
      </form>
    </div>
  </div>
</ng-template>

<!-- ---------------------------------------Cancel Apoointment modal---------------------------------------- -->
<div class="cancel_appointment">
  <ng-template #cancelappintmentcontent let-modal>
    <div class="custome_modal">
      <div class="modal-header">
        <h4 class="modal-title" id="modal-basic-title">
          {{ "cancel_appointment" | translate }}
        </h4>
        <button type="button" class="btn-close" aria-label="Close" (click)="modal.dismiss('Cross click')">
          <mat-icon>close</mat-icon>
        </button>
      </div>
      <div class="modal-body">
        <form>
          <div class="row">
            <div class="item col-md-12">
              <div class="form_field_wrapper">
                <label>{{ "cancellation_reason" | translate }}</label>
                <mat-form-field appearance="fill">
                  <textarea matInput #reason></textarea>
                </mat-form-field>
              </div>
            </div>
          </div>
        </form>
        <div class="primary_btn mt-2">
          <button type="button" class="btn btn-secondary" (click)="modal.dismiss('Cross click')">
            {{ "back" | translate }}
          </button>
          <button type="button" class="btn btn-primary" (click)="apiHandler(reason.value, 'REJECTED')">
            {{ "cancel_appointment" | translate }}
          </button>
        </div>
      </div>
    </div>
  </ng-template>
</div>

<!-- Reject Appointment modal -->
<ng-template #rejectappointment let-modal>
  <div class="custome_modal action_modals">
    <div class="modal-body">
      <div class="delete_screen text-center">
        <div class="image delete">
          <img class="img-fluid" src="../../../../assets/img/cancel.svg" alt="" />
        </div>
        <span class="single_text">{{
          "do_you_really_want_cancel_appointment" | translate
          }}</span>
        <div class="primary_btn mt-30">
          <button type="button" class="btn btn-secondary" (click)="modal.dismiss('Cross click')">
            {{ "no" | translate }}
          </button>
          <button type="button" class="btn btn-primary" (click)="
              openVerticallyCenteredcancelappointment(cancelappintmentcontent)
            ">
            {{ "yes" | translate }}
          </button>
        </div>
      </div>
    </div>
  </div>
</ng-template>

<ng-template #remaindermodal let-modal>
  <div class="custome_modal common_plan">
    <div class="modal-header">
      <h4 class="modal-title text-center" id="modal-basic-title">
        {{ "set_remainders" | translate }}
      </h4>
      <button type="button" class="btn-close" aria-label="Close" (click)="modal.dismiss('Cross click')">
        <mat-icon>close</mat-icon>
      </button>
    </div>
    <div class="modal-body">
      <div class="form_detail">
        <form [formGroup]="remainderForm">
          <div class="row">
            <ng-container formArrayName="remainderrr">
              <ng-container *ngFor="let row of remainderrr1.controls; let i = index">
                <ng-container [formGroupName]="i">
                  <div class="form_field_wrapper">
                    <div class="fieldicon_wrap">
                      <mat-form-field class="inner_label" appearance="fill">
                        <mat-label>{{
                          "choose_before_hour" | translate
                          }}</mat-label>
                        <mat-select placeholder="{{ 'select_type' | translate }}" formControlName="hours">
                          <mat-option *ngFor="let time of timeHourValue" [value]="time.value">{{ time.name
                            }}</mat-option>
                        </mat-select>
                        <mat-error class="text-danger"
                          *ngIf="isSubmitted && remainderrr1['hours']?.errors?.['required']">
                          {{ "field_is_required" | translate }}*
                        </mat-error>
                      </mat-form-field>
                      <mat-form-field class="example-full-width" appearance="fill">
                        <mat-label>{{
                          "choose_before_minutes" | translate
                          }}</mat-label>
                        <mat-select placeholder="{{ 'select_type' | translate }}" formControlName="minutes">
                          <mat-option *ngFor="let time of timeMinuteValue" [value]="time.value">{{ time.name
                            }}</mat-option>
                        </mat-select>
                        <mat-error class="text-danger"
                          *ngIf="isSubmitted && remainderrr1['hours']?.errors?.['required']">
                          {{ "field_is_required" | translate }}*
                        </mat-error>
                      </mat-form-field>

                      <ng-container *ngIf="i === remainderrr1.length - 1; else remove">
                        <mat-icon class="minus" (click)="removeRemainder(i)"
                          *ngIf="remainderrr1.length > 1">remove</mat-icon>
                        <mat-icon class="plus" (click)="addnewRemainder()">add</mat-icon>
                      </ng-container>
                      <ng-template #remove>
                        <mat-icon class="minus" (click)="removeRemainder(i)">remove</mat-icon>
                      </ng-template>
                    </div>
                  </div>
                </ng-container>
              </ng-container>
            </ng-container>

            <div class="vr">{{ "or" | translate }}</div>

            <ng-container formArrayName="remainderDT">
              <ng-container *ngFor="let row of remainderDT.controls; let i = index">
                <ng-container [formGroupName]="i">
                  <div class="form_field_wrapper">
                    <div class="fieldicon_wrap">
                      <mat-form-field>
                        <mat-label>{{ "choose_a_date" | translate }}</mat-label>
                        <input matInput formControlName="dateTime" [ngxMatDatetimePicker]="picker"
                           [min]="minDate" [max]="maxDate" [disabled]="disabled" />
                        <mat-datepicker-toggle matSuffix [for]="$any(picker)"></mat-datepicker-toggle>
                        <ngx-mat-datetime-picker #picker [showSpinners]="showSpinners" [showSeconds]="showSeconds"
                          [stepHour]="stepHour" [stepMinute]="stepMinute" [stepSecond]="stepSecond" [touchUi]="touchUi"
                          [color]="color">
                        </ngx-mat-datetime-picker>
                      </mat-form-field>
                      <mat-error class="text-danger"
                        *ngIf="isSubmitted && remainderDT['dateTime']?.errors?.['required']">
                        {{ "field_is_required" | translate }}*
                      </mat-error>

                      <ng-container *ngIf="i === remainderDT.length - 1; else remove">
                        <mat-icon class="minus" (click)="removeRemainderDT(i)"
                          *ngIf="remainderDT.length > 1">remove</mat-icon>
                        <mat-icon class="plus" (click)="addnewRemainderDT()">add</mat-icon>
                      </ng-container>
                      <ng-template #remove>
                        <mat-icon class="minus" (click)="removeRemainderDT(i)">remove</mat-icon>
                      </ng-template>
                    </div>
                  </div>
                </ng-container>
              </ng-container>
            </ng-container>
          </div>

          <div class="form-btn primary_btn add_popup">
            <button class="login_btn btn btn-primary" (click)="closePopup()">
              {{ "Cancel" | translate }}
            </button>
            <button class="login_btn btn btn-secondary" (click)="setReminderSave()">
              {{ "save" | translate }}
            </button>
          </div>
        </form>
      </div>
    </div>
  </div>
</ng-template>

<div class="edit_staff">
  <ng-template #choosedate let-modal>
    <div class="custome_modal">
      <div class="modal-header">
        <h4 class="modal-title" id="modal-basic-title">
          {{ "reschedule_appointment" | translate }}
        </h4>
        <button type="button" class="btn-close" aria-label="Close" (click)="modal.dismiss('Cross click')">
          <mat-icon>close</mat-icon>
        </button>
      </div>
      <div class="modal-body">
        <div class="resshedule_appointment">
          <div class="image_block">
            <img class="img-fluid" src="{{
                doctordetailsData?.profile_picture?.url
                  ? doctordetailsData?.profile_picture?.url
                  : '../../../assets/img/default_user.png'
              }}" alt="doc" />
          </div>
          <div class="content_block">
            <h3>
              {{ doctordetailsData?.full_name
              }}<span class="status-icon"><img class="img-fluid" src="../../../../../assets/img/greenelip.svg" /></span>
            </h3>
            <p>{{ speciality }}</p>
            <ul>
              <li>
                <div class="doctore_detail">
                  <p>{{ "experience" | translate }}</p>
                  <h4>
                    {{ doctordetailsData?.years_of_experience }}
                    {{ "years" | translate }}
                  </h4>
                </div>
              </li>
              <li>
                <div class="doctore_detail">
                  <p>{{ "rating_and_review" | translate }}</p>
                  <h4>
                    <i class="fa-solid fa-star"></i>
                    {{ doctorRating?.average_rating }} ({{
                    doctorRating?.total_review
                    }}
                    Reviews)
                  </h4>
                </div>
              </li>
              <li>
                <div class="doctore_detail">
                  <p>{{ "next_appointment_available" | translate }}</p>
                  <h4>{{ nextAvailableDate | date : "dd/MM/YYYY" }}</h4>
                </div>
              </li>
            </ul>
          </div>
        </div>
        <div class="choose_slot">
          <div class="heading">
            <h4>1. {{ "choose_slot" | translate }}</h4>
          </div>
          <div class="choose_detail">
            <div class="nearest_slot">
              <p>{{ "nearest_available_slot" | translate }}:</p>
              <h3>
                {{ nextAvailableDate | date : "dd/MM/YYYY" }} ({{
                nearestAvailableSlot
                ? nearestAvailableSlot
                : "No Slot Available"
                }})
              </h3>
            </div>
            <button type="button" class="btn btn-primary" [disabled]="!nearestAvailableSlot"
              (click)="handleRescheduleAppointment('yes')">
              {{ "book_now" | translate }}
            </button>
          </div>
        </div>
        <div class="primary_btn">
          <button type="button" class="btn btn-secondary mr-3" (click)="modal.dismiss('Cross click')">
            {{ "cancel" | translate }}
          </button>
          <button type="button" class="btn btn-primary" (click)="openVerticallyCenteredChooseDateTime(chooseCalender)">
            {{ "view_other_available_slots" | translate }}
          </button>
        </div>
      </div>
    </div>
  </ng-template>
</div>

<div class="edit_staff">
  <ng-template #chooseCalender let-modal>
    <form (ngSubmit)="handleRescheduleAppointment('no')">
      <div class="custome_modal">
        <div class="modal-header">
          <h4 class="modal-title" id="modal-basic-title">
            {{ "reschedule_appointment" | translate }}
          </h4>
          <button type="button" class="btn-close" aria-label="Close" (click)="modal.dismiss('Cross click')">
            <mat-icon>close</mat-icon>
          </button>
        </div>
        <div class="modal-body">
          <div class="resshedule_appointment">
            <div class="image_block">
              <img class="img-fluid" src="{{
                  doctordetailsData?.profile_picture?.url
                    ? doctordetailsData?.profile_picture?.url
                    : '../../../assets/img/default_user.png'
                }}" alt="doc" />
            </div>
            <div class="content_block">
              <h3>
                {{ doctordetailsData?.full_name
                }}<span class="status-icon"><img class="img-fluid"
                    src="../../../../../assets/img/greenelip.svg" /></span>
              </h3>
              <p>{{ speciality }}</p>
              <ul>
                <li>
                  <div class="doctore_detail">
                    <p>{{ "experience" | translate }}</p>
                    <h4>
                      {{ doctordetailsData?.years_of_experience }}
                      {{ "years" | translate }}
                    </h4>
                  </div>
                </li>
                <li>
                  <div class="doctore_detail">
                    <p>{{ "rating_and_review" | translate }}</p>
                    <h4>
                      <i class="fa-solid fa-star"></i>
                      {{ doctorRating?.average_rating }} ({{
                      doctorRating?.total_review
                      }}
                      Reviews)
                    </h4>
                  </div>
                </li>
                <li>
                  <div class="doctore_detail">
                    <p>{{ "next_appointment_available" | translate }}</p>
                    <h4>{{ nextAvailableDate | date : "dd/MM/YYYY" }}</h4>
                  </div>
                </li>
              </ul>
            </div>
          </div>
          <div class="choose_slot">
            <div class="heading">
              <h4>2. {{ "select_date_time" | translate }}</h4>
            </div>
            <div class="choose_detail">
              <div class="expansion_panel_inner">
                <div class="main_outer">
                  <div class="row location_appointment">
                    <div class="expansion_item location col-md-6">
                      <h2>{{ "select_location" | translate }}</h2>
                      <mat-button-toggle-group name="fontStyle" #group="matButtonToggleGroup" aria-label="Font Style"
                        [value]="location_id" [disabled]="true">
                        <!-- {{hospital_location|json}} -->
                        <ng-container *ngFor="let location of hospital_location">
                          <mat-button-toggle [value]="location?.hospital_id"
                            (change)="onSelection({ locationid: $event.value })">{{ location?.hospital_name
                            }}</mat-button-toggle>
                        </ng-container>
                      </mat-button-toggle-group>
                    </div>

                    <div class="expansion_item appointment col-md-6">
                      <h2>{{ "appointment_type" | translate }}</h2>
                      <mat-radio-group aria-label="Appointment Type">
                        <!-- <mat-radio-button
                            [value]="type.appointment_type"
                            *ngFor="let type of doctor_availability"
                            (change)="onSelection({ type: $event.value })"
                          >
                            {{ type?.appointment_type }}
                          </mat-radio-button> -->
                        <mat-radio-button value="Online" (change)="onSelection({ type: $event.value })"
                          [checked]="appointment_type === 'Online'" [disabled]="true">
                          {{ "online" | translate }}
                        </mat-radio-button>

                        <mat-radio-button value="Home Visit" (change)="onSelection({ type: $event.value })"
                          [checked]="appointment_type === 'Home Visit'" [disabled]="true">
                          {{ "home_visit" | translate }}
                        </mat-radio-button>

                        <mat-radio-button value="Face to Face" (change)="onSelection({ type: $event.value })"
                          [checked]="appointment_type === 'Face to Face'" [disabled]="true">
                          {{ "hospital_visit" | translate }}
                        </mat-radio-button>
                      </mat-radio-group>
                    </div>
                  </div>

                  <div class="consultation_datetime">
                    <h2>{{ "choose_consultation_date_time" | translate }}</h2>
                    <div class="consultation_datetime_inner row">
                      <div class="expansion_item col-md-7">
                        <article class="calendar-wrapper">
                          <igx-calendar #calendar [value]="value"
                            (selected)="onSelection({ date: $event })"></igx-calendar>
                        </article>
                      </div>
                      <div class="expansion_item col-md-5">
                        <h2>{{ "choose_time" | translate }}</h2>

                        <mat-button-toggle-group name="fontStyle" aria-label="Font Style">
                          <ng-container *ngFor="let slot of doctorAvailableTimeSlot">
                            <ng-container *ngIf="slot?.status == 0">
                              <mat-button-toggle [checked]="choose_slot == slot?.slot" [value]="slot.slot" #slott
                                (click)="handleSelectSlot(slott.value)">{{ slot?.slot }}</mat-button-toggle>
                            </ng-container>
                            <ng-container *ngIf="slot?.status == 1">
                              <mat-button-toggle [checked]="choose_slot == slot?.slot" class="disabled"
                                [disabled]="true" [value]="slot?.slot">{{ slot?.slot }}</mat-button-toggle>
                            </ng-container>
                          </ng-container>
                        </mat-button-toggle-group>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
          <div class="primary_btn mt-4">
            <button type="button" class="btn btn-secondary mr-3" (click)="modal.dismiss('Cross click')">
              {{ "cancel" | translate }}
            </button>
            <button type="submit" class="btn btn-primary" [disabled]="!choose_slot">
              {{ "book" | translate }}
            </button>
          </div>
        </div>
      </div>
    </form>
  </ng-template>
</div>